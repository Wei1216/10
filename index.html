<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å–®å…ƒå-é¢çš„å¤§å°æ¯”è¼ƒ</title>
<style>

@font-face {
  font-family: 'BpmfGenSenRounded-B'; /* çµ¦å­—é«”ä¸€å€‹è‡ªè¨‚åç¨± */
  /* è«‹ç¢ºèªé€™å€‹è·¯å¾‘æ˜¯æ­£ç¢ºçš„ */
  src: url('BpmfGenSenRounded-B.ttf') format('truetype'); 
  font-weight: normal;
  font-style: normal;
}
  
  body {
    margin: 0;
    /* ç¢ºä¿ç¬¬ä¸€å€‹å­—é«”åç¨±èˆ‡ @font-face ä¸­çš„ family åç¨±ä¸€è‡´ */
    font-family: "BpmfGenSenRounded-B", "Microsoft JhengHei", sans-serif; 
    display: flex;
    height: 100vh;
    background: #f8f8f8;
  }

  /* === å·¦å´ï¼šé¸è™Ÿå™¨ === */
  .lottery-container {
    flex: 0 0 200px;
    background: rgba(255, 255, 255, 0.85);
    border-right: 3px solid #98d0de;
    display: flex;
    flex-direction: column;
    /* *** ä¿®æ­£ï¼šå°‡å…§å®¹é ä¸Šå°é½Šä»¥æ¨¡æ“¬ç¸®çŸ­æ•ˆæœ *** */
    justify-content: flex-start;
    align-items: center;
    box-shadow: 2px 0 8px rgba(0,0,0,0.1);
    text-align: center;
    /* *** ä¿®æ­£ï¼šèª¿æ•´ padding æ¸›å°‘ä¸Šä¸‹ç©ºé–“ *** */
    padding: 15px 20px; 
  }

  .title { font-size: 20px; font-weight: bold; color: #333; margin-top: 10px; margin-bottom: 10px; }
  .number-display {
    width: 70px; height: 50px;
    border: 3px solid #98d0de;
    border-radius: 8px;
    display: flex; justify-content: center; align-items: center;
    background: linear-gradient(45deg, #f8f9ff, #e8ecff);
  }
  .number { font-size: 26px; font-weight: bold; color: #98d0de; }
  .progress-bar {
    width: 120px; height: 6px;
    background: #eee; border-radius: 3px;
    margin: 10px auto; overflow: hidden;
  }
  .progress-fill {
    height: 100%;
    background: linear-gradient(45deg, #98d0de, #7bc4d4);
    width: 0%;
    transition: width 0.1s linear;
  }
  .status-text { font-size: 13px; color: #666; margin-top: 5px; }
  .lottery-btn {
    margin-top: 15px;
    padding: 6px 16px;
    background: linear-gradient(45deg, #98d0de, #7bc4d4);
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-family: "BpmfGenSenRounded-B", "Microsoft JhengHei", sans-serif;
  }

  .spinning { animation: spin 0.1s linear infinite; }
  @keyframes spin {
    0% { transform: translateY(-20px); opacity: 0.5; }
    50% { transform: translateY(0); opacity: 1; }
    100% { transform: translateY(20px); opacity: 0.5; }
  }

  /* === æ–°å¢ï¼šO/X é¸æ“‡å™¨æ¨£å¼ === */
  .ox-selector {
    width: 150px; /* å¯¬åº¦èˆ‡é€²åº¦æ¢ç´„ç•¥ç›¸ç•¶ */
    margin-top: 25px; 
    padding-top: 15px;
    border-top: 2px dashed #ccc;
    display: flex;
    justify-content: space-around;
    align-items: center;
    height: 70px; /* åƒ…æ¯”å…©å€‹æŒ‰éˆ•é«˜åº¦å¤šä¸€é» */
    display: none; /* é è¨­éš±è—ï¼Œåªæœ‰åœ¨ç­”é¡Œç’°ç¯€æ‰é¡¯ç¤º */
  }
  .ox-btn {
    width: 60px;
    height: 50px;
    font-size: 24px;
    font-weight: bold;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: opacity 0.1s;
    font-family: "BpmfGenSenRounded-B", "Microsoft JhengHei", sans-serif;
  }
  #oxBtnO { background-color: #4CAF50; }
  #oxBtnX { background-color: #F44336; }
  .ox-btn:hover { opacity: 0.8; }

  /* === å³å´ï¼šè·‘é¦¬ç‡ˆï¼åœ–ç‰‡é¡¯ç¤ºå€ (æ–°å¢ position/z-index ä¿®æ­£) === */
  #main-area {
    flex: 1;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    position: relative;
  }
  #marquee {
    font-size: 2rem;
    font-weight: bold;
    color: #333;
    text-align: center;
    padding: 20px;
    z-index: 1;
    position: relative; 
  }
  #main-image {
    max-width: 90%;
    max-height: 85%;
    border-radius: 10px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    display: none;
    z-index: 1;
    position: relative;
  }
  #start-btn {
    margin-top: 30px;
    padding: 10px 25px;
    font-size: 1.2rem;
    background: linear-gradient(45deg, #98d0de, #7bc4d4);
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-family: "BpmfGenSenRounded-B", "Microsoft JhengHei", sans-serif;
  }
  
  /* === æ–°å¢ï¼šO/X åœ–ç‰‡è¦†è“‹å±¤ (è·‘é¦¬ç‡ˆæœ€ä¸Šå±¤) === */
  #ox-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    display: none; /* é è¨­éš±è— */
    justify-content: center;
    align-items: center;
    background: rgba(255, 255, 255, 0.6); /* åŠé€æ˜èƒŒæ™¯ */
    z-index: 10; /* ç¢ºä¿åœ¨æœ€ä¸Šå±¤ */
    pointer-events: none; /* å…è¨±é»æ“Šç©¿é€åˆ°ä¸‹é¢çš„å…ƒç´  */
  }
  .ox-img {
    font-size: 15vw; /* è®“ O/X ç¬¦è™Ÿéå¸¸å¤§ */
    font-weight: bold;
    opacity: 0;
    animation: fade-and-scale 1.5s ease-out forwards;
  }
  @keyframes fade-and-scale {
    0% { transform: scale(0.5); opacity: 0; }
    50% { transform: scale(1.1); opacity: 1; }
    100% { transform: scale(1); opacity: 0; }
  }
</style>
</head>
<body>

<audio id="rollingSound" loop>
    <source src="rolling.mp3" type="audio/mpeg">
</audio>

<audio id="chimeSound">
    <source src="chime.mp3" type="audio/mpeg">
</audio>

<audio id="correctSound">
    <source src="correct.mp3" type="audio/mpeg">
</audio>

<audio id="wrongSound">
    <source src="wrong.mp3" type="audio/mpeg">
</audio>


<div class="lottery-container">
  <div class="title">é¸è™Ÿå™¨</div>
  <div class="number-display"><div class="number" id="numberDisplay">?</div></div>
  <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
  <div class="status-text" id="statusText">ç­‰å¾…å•Ÿå‹•</div>
  <button class="lottery-btn" id="lotteryBtn">æŠ½è™Ÿç¢¼</button>
  
    <div class="ox-selector" id="oxSelector">
    <button class="ox-btn" id="oxBtnO">O</button>
    <button class="ox-btn" id="oxBtnX">X</button>
  </div>
</div>

<div id="main-area">
    <div id="ox-overlay">
  </div>
  <div id="marquee">æŒ‰ã€Œé–‹å§‹æŠ½é¡Œã€</div>
  <img id="main-image" src="">
  <button id="start-btn">é–‹å§‹æŠ½é¡Œ</button>
</div>

<script>
/* ====== é¸è™Ÿå™¨æ§åˆ¶ï¼ˆç¨ç«‹é‹ä½œï¼‰ ====== */
let isRunning = false;
let animationInterval, progressInterval;

// å–å¾—éŸ³æ•ˆå…ƒç´ 
const rollingSound = document.getElementById('rollingSound');
const chimeSound = document.getElementById('chimeSound');
// æ–°å¢ O/X éŸ³æ•ˆ
const correctSound = document.getElementById('correctSound');
const wrongSound = document.getElementById('wrongSound');


function getRandomNumber() {
  return Math.floor(Math.random() * 25) + 2; // 2~26
}

// ... startLottery å‡½æ•¸ä¿æŒä¸è®Š ...
function startLottery() {
  if (isRunning) return;
  isRunning = true;

  const numberDisplay = document.getElementById('numberDisplay');
  const statusText = document.getElementById('statusText');
  const progressFill = document.getElementById('progressFill');

  numberDisplay.className = 'number spinning';
  statusText.textContent = 'æŠ½ç±¤ä¸­...';
  progressFill.style.width = '0%';

  // é–‹å§‹æ’­æ”¾æ»¾å‹•éŸ³æ•ˆ
  if(rollingSound) {
    rollingSound.currentTime = 0; 
    rollingSound.play().catch(e => console.error("æ»¾å‹•éŸ³æ•ˆæ’­æ”¾å¤±æ•—:", e)); 
  }

  let progress = 0;
  const totalTime = 2000;
  const updateInterval = 50;

  animationInterval = setInterval(() => {
    numberDisplay.textContent = getRandomNumber();
  }, 100);

  progressInterval = setInterval(() => {
    progress += updateInterval;
    progressFill.style.width = (progress / totalTime) * 100 + '%';
    if (progress >= totalTime) clearInterval(progressInterval);
  }, updateInterval);

  setTimeout(() => {
    clearInterval(animationInterval);

    // åœæ­¢æ»¾å‹•éŸ³æ•ˆä¸¦æ’­æ”¾çµæŸéŸ³æ•ˆ
    if(rollingSound) rollingSound.pause(); 
    if(chimeSound) {
        chimeSound.currentTime = 0;
        chimeSound.play().catch(e => console.error("çµæŸéŸ³æ•ˆæ’­æ”¾å¤±æ•—:", e));
    }
    
    const finalNumber = getRandomNumber();
    numberDisplay.textContent = finalNumber;
    numberDisplay.className = 'number final-result';
    statusText.textContent = `ğŸ‰ æŠ½ä¸­è™Ÿç¢¼ï¼š${finalNumber}`;
    progressFill.style.width = '100%';
    isRunning = false;
  }, totalTime);
}
document.getElementById("lotteryBtn").onclick = startLottery;


/* ====== æŠ½é¡Œé‚è¼¯ ====== */
const questionPool = [
  { type: "A", text: "é¡Œç›®ï¼šæœ‰å¹³é¢å—ï¼Ÿ", images: ["15.png"] },
  { type: "A", text: "é¡Œç›®ï¼šæœ‰å¹³é¢å—ï¼Ÿ", images: ["19.png"] },
  { type: "A", text: "é¡Œç›®ï¼šæœ‰å¹³é¢å—ï¼Ÿ", images: ["23.png"] },

  { type: "B", text: "é¡Œç›®ï¼šå“ªå€‹é¢æ¯”è¼ƒå¤§ï¼Ÿ", images: ["16.png"] },
  { type: "B", text: "é¡Œç›®ï¼šå“ªå€‹é¢æ¯”è¼ƒå¤§ï¼Ÿ", images: ["20.png"] },
  { type: "B", text: "é¡Œç›®ï¼šå“ªå€‹é¢æ¯”è¼ƒå¤§ï¼Ÿ", images: ["24.png"] },

  { type: "C", text: "é¡Œç›®ï¼šæ€éº¼æ¯”è¼ƒï¼Ÿ", images: [
    "17.png",
    "18.png"
  ]},

  { type: "C", text: "é¡Œç›®ï¼šæ€éº¼æ¯”è¼ƒï¼Ÿ", images: [
    "21.png",
    "22.png"
  ]},

  { type: "C", text: "é¡Œç›®ï¼šæ€éº¼æ¯”è¼ƒï¼Ÿ", images: [
    "25.png",
    "26.png"
  ]}
];

let remaining = [...questionPool];
let drawCount = 0;
let currentQ = null;
let currentImgIndex = 0;

const marquee = document.getElementById("marquee");
const img = document.getElementById("main-image");
const startBtn = document.getElementById("start-btn");

// æ–°å¢ O/X å…ƒç´ åƒç…§
const oxSelector = document.getElementById("oxSelector");
const oxOverlay = document.getElementById('ox-overlay');

// æ–°å¢ O/X æŒ‰éˆ•çš„äº‹ä»¶ç›£è½
document.getElementById("oxBtnO").onclick = () => handleOxClick('O');
document.getElementById("oxBtnX").onclick = () => handleOxClick('X');

startBtn.onclick = startMarquee;
// ä¿®æ”¹: é»æ“Šåœ–ç‰‡ä¸å†ç›´æ¥åˆ‡æ›æˆ–é‡ç½®ï¼Œè€Œæ˜¯é€²å…¥ O/X é¸æ“‡æ¨¡å¼
img.onclick = handleImageClick; 

// === æŠ½é¡Œå‡½å¼ (åŒ…å« 1 ç§’å»¶é²é‚è¼¯) ===
// ... startMarquee å‡½æ•¸ä¿æŒä¸è®Š ...

// === æ§åˆ¶å‰ä¸‰é¡Œå¿…å‡ºç‰¹å®šé¡å‹ ===
// ... getNextQuestion å‡½æ•¸ä¿æŒä¸è®Š ...

// === é¡¯ç¤ºé¡Œç›®åœ–ç‰‡ ===
// ... showImage å‡½æ•¸ä¿æŒä¸è®Š ...

// === é»æ“Šåœ–ç‰‡é€²è¡Œåˆ‡æ›æˆ–é‡ç½® (ä¿®æ”¹é‚è¼¯) ===
function handleImageClick() {
  if (!currentQ) return;
  currentImgIndex++;
  if (currentImgIndex < currentQ.images.length) {
    // é‚„æœ‰åœ–ç‰‡ï¼Œåˆ‡æ›ä¸‹ä¸€å¼µ
    img.src = currentQ.images[currentImgIndex];
  } else {
    // åœ–ç‰‡å·²æ’­å®Œï¼Œé€²å…¥ O/X é¸æ“‡ç’°ç¯€
    enterOxSelection();
  }
}

// === æ–°å¢ï¼šé€²å…¥ O/X é¸æ“‡æ¨¡å¼çš„å‡½å¼ ===
function enterOxSelection() {
  img.style.display = "none";
  marquee.textContent = "è«‹é¸æ“‡åœˆ (O) æˆ–å‰ (X)";
  marquee.style.display = "block";
  oxSelector.style.display = "flex"; // é¡¯ç¤º O/X æŒ‰éˆ•
}

// === æ–°å¢ï¼šè™•ç† O/X æŒ‰éˆ•é»æ“Šçš„å‡½å¼ ===
function handleOxClick(type) {
    // 1. éš±è— O/X é¸æ“‡å™¨
    oxSelector.style.display = 'none';

    // 2. æ±ºå®šåœ–ç‰‡å…§å®¹å’ŒéŸ³æ•ˆ
    let content, soundElement;
    if (type === 'O') {
        content = `<div class="ox-img" style="color: #4CAF50;">&#10004;</div>`; 
        soundElement = correctSound;
    } else { // X
        content = `<div class="ox-img" style="color: #F44336;">&#10008;</div>`; 
        soundElement = wrongSound;
    }

    // 3. é¡¯ç¤º O/X åœ–ç‰‡ (åœ¨è·‘é¦¬ç‡ˆæœ€ä¸Šå±¤)
    oxOverlay.innerHTML = content;
    oxOverlay.style.display = 'flex';
    
    // 4. æ’­æ”¾éŸ³æ•ˆ
    if (soundElement) {
        soundElement.currentTime = 0;
        soundElement.play().catch(e => console.error(`æ’­æ”¾ ${type} éŸ³æ•ˆå¤±æ•—:`, e));
    }

    // 5. åœ–ç‰‡å’ŒéŸ³æ•ˆæ’­æ”¾å®Œç•¢å¾Œï¼ŒåŸ·è¡Œé¡Œç›®å®Œæˆå¾Œçš„é‡ç½®
    setTimeout(() => {
        oxOverlay.style.display = 'none';
        oxOverlay.innerHTML = ''; // æ¸…ç©ºå…§å®¹
        resetAfterQuestion();
    }, 1500); // 1.5 ç§’èˆ‡ CSS å‹•ç•«æ™‚é–“ä¿æŒä¸€è‡´
}


// === é¡Œç›®å®Œæˆå¾Œé‡ç½® (ä¿æŒä¸è®Š) ===
function resetAfterQuestion() {
  remaining = remaining.filter(q => q !== currentQ);
  currentQ = null;
  img.style.display = "none";
  
  // é‡æ–°é¡¯ç¤ºé¡Œç›®æ–‡å­—ä¸¦è¨­å®šå…§å®¹
  marquee.textContent = "æŒ‰ã€Œé–‹å§‹æŠ½é¡Œã€";
  marquee.style.display = "block"; 

  startBtn.style.display = "block";
}
</script>


</body>
</html>
